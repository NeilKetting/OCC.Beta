<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:OCC.Client.Features.BugHub.ViewModels;assembly=OCC.Client"
        mc:Ignorable="d"
        x:Class="OCC.Client.Features.BugHub.Views.BugReportDialog"
        x:DataType="vm:BugReportDialogViewModel"
        Title="Submit Feedback"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        Width="500"
        Height="500"
        SystemDecorations="None"
        Background="Transparent">

    <Border Background="White" CornerRadius="8" BorderBrush="{DynamicResource BorderGray}" BorderThickness="1" ClipToBounds="True">
        <Grid RowDefinitions="Auto, *, Auto">
            <!-- Header -->
            <Border Grid.Row="0" Background="#EF6C00" Padding="15">
                <Grid ColumnDefinitions="*, Auto">
                    <StackPanel Spacing="5">
                        <TextBlock Text="Submit Feedback" FontSize="20" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="Help us improve by reporting bugs or sharing suggestions." FontSize="12" Foreground="White" Opacity="0.9"/>
                    </StackPanel>
                    <PathIcon Grid.Column="1" Data="{StaticResource IconBug}" Foreground="White" Width="32" Height="32"/>
                </Grid>
            </Border>

            <!-- Content -->
            <Border Grid.Row="1" Padding="20">
                <StackPanel Spacing="15">
                    
                    <StackPanel Spacing="5">
                        <TextBlock Text="Detected View" Classes="FormLabel"/>
                        <TextBox Text="{Binding ViewName}" IsReadOnly="True" Background="#F1F5F9" Foreground="#64748B"/>
                    </StackPanel>

                    <StackPanel Spacing="5">
                        <TextBlock Text="Feedback Type" Classes="FormLabel"/>
                        <ComboBox ItemsSource="{Binding AvailableTypes}" 
                                  SelectedItem="{Binding SelectedType}" 
                                  HorizontalAlignment="Stretch"/>
                    </StackPanel>

                    <StackPanel Spacing="5">
                        <TextBlock Text="Description" Classes="FormLabel"/>
                        <TextBox Text="{Binding Description}" 
                                 Height="150" 
                                 AcceptsReturn="True" 
                                 TextWrapping="Wrap" 
                                 Watermark="Please describe what happened..."/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Spacing="5" IsVisible="{Binding ScreenshotBase64, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <PathIcon Data="{StaticResource IconCheck}" Width="12" Height="12" Foreground="Green"/>
                        <TextBlock Text="Screenshot captured automatically" FontSize="11" Foreground="Green" VerticalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Footer -->
            <Border Grid.Row="2" Background="#F8FAFC" Padding="15" BorderBrush="{DynamicResource BorderGray}" BorderThickness="0,1,0,0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
                    <Button Content="Submit Report" Command="{Binding SubmitCommand}" Classes="Primary" IsEnabled="{Binding !IsSubmitting}"/>
                    <Button Content="Cancel" Command="{Binding CancelCommand}" Classes="Cancel"/>
                </StackPanel>
            </Border>

            <!-- Loading Overlay -->
            <Grid Grid.RowSpan="3" Background="#80FFFFFF" IsVisible="{Binding IsSubmitting}">
                <TextBlock Text="Submitting..." HorizontalAlignment="Center" VerticalAlignment="Center" FontWeight="SemiBold"/>
            </Grid>
        </Grid>
    </Border>
</Window>
