<Styles xmlns="https://github.com/avaloniaui"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:controls="clr-namespace:OCC.Client.Controls">

	<Design.PreviewWith>
		<StackPanel>
			<Border Padding="20">
				<controls:SearchableComboBox Width="250" Watermark="Search items..." />
			</Border>

			<Border Padding="20">
				<controls:SearchableComboBox Width="250" Watermark="Search items..." />
			</Border>
		</StackPanel>
	</Design.PreviewWith>

	<Style Selector="controls|SearchableComboBox">
		<Setter Property="VerticalAlignment" Value="Center" />
		<Setter Property="Height" Value="32" />
		<Setter Property="Padding" Value="0" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderLow}" />
		<Setter Property="Background" Value="White" />
		<Setter Property="Template">
			<ControlTemplate>
				<Grid>
					<Grid ColumnDefinitions="*, Auto">
						<Border Name="PART_BorderElement"
								Grid.ColumnSpan="2"
								Background="{TemplateBinding Background}"
								BorderBrush="{TemplateBinding BorderBrush}"
								BorderThickness="{TemplateBinding BorderThickness}"
								CornerRadius="4" />

						<TextBox Name="PART_TextBox"
								 Grid.Column="0"
								 Padding="8,0"
								 Height="{TemplateBinding Height}"
								 Watermark="{TemplateBinding Watermark}"
								 BorderThickness="0"
								 Background="Transparent"
								 VerticalContentAlignment="Center"
								 FontSize="12" />

						<Border Grid.Column="1"
								Width="1"
								VerticalAlignment="Stretch"
								Background="{DynamicResource ThemeBorderLow}"
								Margin="0,4"
								IsVisible="{TemplateBinding IsDropdownButtonVisible}"/>

						<Button Name="PART_ToggleButton"
								Grid.Column="1"
								Width="30"
								Height="{TemplateBinding Height}"
								Background="LightGray"
								BorderThickness="0"
								CornerRadius="0,4,4,0"
								Padding="0"
								IsVisible="{TemplateBinding IsDropdownButtonVisible}"
								Focusable="False"
								Cursor="Hand">
							<PathIcon Data="{StaticResource IconChevronDown}"
									  Width="12"
									  Height="12"
									  Foreground="{DynamicResource TextSecondaryGray}" />
						</Button>
					</Grid>

					<Popup Name="PART_Popup"
						   WindowManagerAddShadowHint="True"
						   IsLightDismissEnabled="True"
						   PlacementTarget="{Binding ElementName=PART_BorderElement}"
						   MinWidth="{Binding Bounds.Width, ElementName=PART_BorderElement}">
						<Border Name="PART_SuggestionsContainer"
								Background="White"
								BorderBrush="{DynamicResource ThemeBorderMid}"
								BorderThickness="1"
								CornerRadius="4"
								Margin="0,4,0,4"
								BoxShadow="0 4 12 0 #20000000">
							<Grid RowDefinitions="Auto, *">
								<!-- Add New Section -->
								<Button Name="PART_AddNewButton"
										Grid.Row="0"
										HorizontalAlignment="Stretch"
										HorizontalContentAlignment="Left"
										Padding="12,8"
										Background="Transparent"
										Foreground="{DynamicResource PrimaryTeal}"
										Command="{TemplateBinding AddNewCommand}"
										IsVisible="{Binding !!AddNewCommand, RelativeSource={RelativeSource TemplatedParent}}">
									<StackPanel Orientation="Horizontal" Spacing="8">
										<PathIcon Data="{StaticResource IconPlus}" Width="10" Height="10" />
										<StackPanel Orientation="Horizontal" Spacing="4">
											<TextBlock Text="{TemplateBinding AddNewLabel}" FontSize="12" />
											<TextBlock Text="{Binding Text, ElementName=PART_TextBox}"
													   FontSize="12"
													   FontWeight="SemiBold"
													   TextTrimming="CharacterEllipsis"
													   MaxWidth="200"/>
										</StackPanel>
									</StackPanel>
								</Button>

								<ListBox Name="PART_SelectingItemsControl"
										 Grid.Row="1"
										 BorderThickness="0"
										 Background="Transparent"
										 ItemTemplate="{TemplateBinding ItemTemplate}"
										 Padding="0,0,0,0"
										 MaxHeight="300">
									<ListBox.Styles>
										<Style Selector="ListBoxItem">
											<Setter Property="Padding" Value="12,6" />
											<Setter Property="FontSize" Value="12" />
										</Style>
									</ListBox.Styles>
								</ListBox>
							</Grid>
						</Border>
					</Popup>
				</Grid>
			</ControlTemplate>
		</Setter>
	</Style>

	<!-- PointerOver State -->
	<Style Selector="controls|SearchableComboBox:pointerover /template/ Border#PART_BorderElement">
		<Setter Property="BorderBrush" Value="{DynamicResource PrimaryTeal}" />
	</Style>

	<!-- Focused State -->
	<Style Selector="controls|SearchableComboBox:focus-within /template/ Border#PART_BorderElement">
		<Setter Property="BorderBrush" Value="{DynamicResource PrimaryTeal}" />
		<Setter Property="BorderThickness" Value="2" />
	</Style>

	<!-- Custom Button Hover Behavior to avoid standard button borders -->
	<Style Selector="controls|SearchableComboBox /template/ Button#PART_ToggleButton:pointerover /template/ ContentPresenter">
		<Setter Property="Background" Value="#10000000" />
		<Setter Property="BorderThickness" Value="0" />
	</Style>
	<Style Selector="controls|SearchableComboBox /template/ Button#PART_ToggleButton:pressed /template/ ContentPresenter">
		<Setter Property="Background" Value="#20000000" />
		<Setter Property="BorderThickness" Value="0" />
	</Style>

</Styles>
