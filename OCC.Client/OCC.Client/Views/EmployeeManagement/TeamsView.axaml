<UserControl xmlns="https://github.com/avaloniaui"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:vm="clr-namespace:OCC.Client.ViewModels.EmployeeManagement"
			 xmlns:models="using:OCC.Shared.Models"
			 mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
			 x:Class="OCC.Client.Views.EmployeeManagement.TeamsView"
			 x:DataType="vm:TeamManagementViewModel">

	<Grid RowDefinitions="Auto, Auto, *">
		<!-- Toolbar -->
		<Border Grid.Row="0" Margin="0,0,0,20" Classes="TopHeader" Background="{DynamicResource WeatheredCementGradient}">
			<Grid ColumnDefinitions="*, Auto">
				<StackPanel Orientation="Horizontal" Spacing="10">
					<StackPanel Grid.Column="0" Spacing="5">
						<TextBlock Text="Teams List" FontSize="{StaticResource FontSizeLarge}" FontWeight="Bold" />
						<TextBlock Text="Create teams for group task assignments" Foreground="#94A3B8" FontSize="{StaticResource FontsizeMedium}" />
					</StackPanel>
					<!-- Stats -->
					<StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
						<StackPanel Classes="Stat" HorizontalAlignment="Stretch">
							<TextBlock Text="Teams" FontSize="20" FontWeight="SemiBold" HorizontalAlignment="Center"/>
							<TextBlock Text="{Binding Teams.Count, FallbackValue=1, StringFormat='({0})'}"  HorizontalAlignment="Center"/>
						</StackPanel>
					</StackPanel>
				</StackPanel>

				<Button Grid.Column="1" Command="{Binding AddTeamCommand}" Classes="Primary">
					<StackPanel Orientation="Horizontal" Spacing="5">
						<PathIcon Data="{StaticResource IconAddUser}" Width="16" Height="16"/>
						<TextBlock Text="Create Team"/>
					</StackPanel>
				</Button>
			</Grid>
		</Border>

		<!-- Error Message -->
		<TextBlock Grid.Row="1" Text="{Binding ErrorMessage}" Foreground="Red" Margin="0,0,0,10"
				   IsVisible="{Binding !!ErrorMessage}" TextWrapping="Wrap" HorizontalAlignment="Center"/>

		<!-- Grid -->
		<DataGrid Grid.Row="2" ItemsSource="{Binding Teams}" SelectedItem="{Binding SelectedTeam}"
				  AutoGenerateColumns="False" IsReadOnly="True"
				  HeadersVisibility="Column" GridLinesVisibility="Horizontal" Background="White"
				  DoubleTapped="DataGrid_DoubleTapped">

			<DataGrid.Styles>
				<Style Selector="DataGridRow" x:DataType="models:Team">
					<Setter Property="ContextMenu">
						<ContextMenu>
							<MenuItem Header="Edit" Command="{Binding $parent[UserControl].((vm:TeamManagementViewModel)DataContext).EditTeamCommand}" CommandParameter="{Binding .}"/>
							<MenuItem Header="Delete" Command="{Binding $parent[UserControl].((vm:TeamManagementViewModel)DataContext).DeleteTeamCommand}" CommandParameter="{Binding .}" Foreground="Red"/>
						</ContextMenu>
					</Setter>
				</Style>
			</DataGrid.Styles>
			<DataGrid.Columns>
				<DataGridTextColumn Header="NAME" Binding="{Binding Name}" Width="*"/>
				<DataGridTextColumn Header="DESCRIPTION" Binding="{Binding Description}" Width="2*"/>

				<DataGridTemplateColumn Width="Auto">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<Button Classes="IconButton" Command="{Binding $parent[UserControl].((vm:TeamManagementViewModel)DataContext).DeleteTeamCommand}" CommandParameter="{Binding .}" Foreground="Red">
								<PathIcon Data="{StaticResource IconTrash}" Width="16" Height="16"/>
							</Button>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</DataGrid>

		<!-- Loading -->
		<StackPanel Grid.Row="2" VerticalAlignment="Center" HorizontalAlignment="Center" IsVisible="{Binding IsBusy}">
			<ProgressBar IsIndeterminate="True" Width="200" Foreground="{DynamicResource OCCOrange}"/>
			<TextBlock Text="{Binding BusyText}" HorizontalAlignment="Center" Margin="0,10,0,0" Classes="LabelSmall"/>
		</StackPanel>
	</Grid>
</UserControl>
